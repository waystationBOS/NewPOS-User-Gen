<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Generator</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

<style>
*, *::before, *::after { box-sizing: border-box; }

/* üåô ALWAYS DARK MODE */
:root {
  --bg: #0f1116;
  --card: #1a1d24;
  --text: #e8ecf2;
  --subtext: #c7cbd1;
  --border: #2a2f38;
  --input-bg: #1f222a;
  --output-bg: #16181d;
  --shadow: rgba(0,0,0,0.5);
}

body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: var(--bg);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
  color: var(--text);
  transition: background .3s, color .3s;
}

/* Main Card */
.container {
  width: 100%;
  max-width: 460px;
  background: var(--card);
  padding: 28px;
  border-radius: 14px;
  box-shadow: 0 12px 35px var(--shadow);
  animation: fadeIn .4s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Form Fields */
.field { margin-bottom: 18px; }
.field label {
  font-size: 13px;
  font-weight: 600;
  color: var(--subtext);
  margin-bottom: 6px;
  display: block;
}

.input-wrapper { position: relative; }
.input-wrapper i {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #888;
}

input, select {
  width: 100%;
  padding: 11px 12px 11px 38px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--text);
  font-size: 14px;
}
input:focus, select:focus {
  border-color: #457b9d;
  box-shadow: 0 0 0 2px rgba(69,123,157,.25);
}

/* Buttons */
button {
  width: 100%;
  padding: 13px;
  margin-top: 12px;
  border-radius: 8px;
  border: none;
  background: #1d3557;
  color: #fff;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}
button:hover { background: #274b7a; }

.copy-btn { background: #2a9d8f; }
.copy-btn:hover { background: #21867a; }

.history-btn { background: #6c5ce7; }
.history-btn:hover { background: #5846d6; }

/* Output Box */
pre {
  margin-top: 8px;
  padding: 16px;
  background: var(--output-bg);
  border-radius: 8px;
  border: 1px solid var(--border);
  white-space: pre-wrap;
  max-height: 220px;
  overflow: auto;
  font-family: Consolas, monospace;
  font-size: 13px;
}

/* History Panel */
#historyPanel {
  position: fixed;
  top: 0;
  right: -400px;
  width: 350px;
  height: 100%;
  background: var(--card);
  border-left: 1px solid var(--border);
  padding: 20px;
  box-shadow: -5px 0 20px var(--shadow);
  transition: .3s;
  overflow-y: auto;
  z-index: 9998;
}
#historyPanel.open { right: 0; }

.history-item {
  background: var(--output-bg);
  border: 1px solid var(--border);
  padding: 10px;
  border-radius: 8px;
  margin-bottom: 10px;
  font-family: Consolas, monospace;
}

/* Toast */
#toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #2a9d8f;
  padding: 10px 16px;
  border-radius: 6px;
  color: #fff;
  opacity: 0;
  transition: .3s;
}
#toast.show { opacity: 1; }
</style>
</head>

<body>

<div class="container">

<h2><i class="fa-solid fa-user-shield"></i> NewPOS61 User Generator</h2>

<div class="field">
  <label>Badge Number</label>
  <div class="input-wrapper">
    <i class="fa-solid fa-id-badge"></i>
    <input id="badge">
  </div>
</div>

<div class="field">
  <label>Name</label>
  <div class="input-wrapper">
    <i class="fa-solid fa-user"></i>
    <input id="empName">
  </div>
</div>

<div class="field">
  <label>Password</label>
  <div class="input-wrapper">
    <i class="fa-solid fa-key"></i>
    <input id="password">
  </div>
</div>

<div class="field">
  <label>Job Code</label>
  <div class="input-wrapper">
    <i class="fa-solid fa-briefcase"></i>
    <select id="job">
      <option value="0">Crew</option>
      <option value="86">Manager</option>
      <option value="88">GM</option>
    </select>
  </div>
</div>

<button onclick="generateSecurityLine()">
  <i class="fa-solid fa-gear"></i> Generate
</button>

<button class="history-btn" onclick="toggleHistory()">
  <i class="fa-solid fa-clock-rotate-left"></i> History
</button>

<div class="output-label" style="margin-top:20px;font-weight:700;">OUTPUT</div>
<pre id="output"></pre>

<button class="copy-btn" onclick="copyOutput()">
  <i class="fa-solid fa-copy"></i> Copy
</button>

<footer style="text-align:center;margin-top:8px;font-size:11px;">
  Internal Use Tool
</footer>

</div>

<div id="historyPanel"></div>
<div id="toast">Copied!</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>

<script>
/* üîê SECURITY ENGINE */
function makeMD5Hash(data){
  let h = CryptoJS.MD5(data).toString(), o = '', w = (h.length%2?'0':'') + h;
  for(let i=0;i<w.length;i++){ if(!(i%2===0 && w[i]==='0')) o+=w[i]; }
  return o;
}
function makeEncryptedPassword(u,p){
  let h = CryptoJS.HmacMD5(u,p).toString(), o = '', w = (h.length%2?'0':'') + h;
  for(let i=0;i<w.length;i++){ if(!(i%2===0 && w[i]==='0')) o+=w[i]; }
  return o;
}
function makeSecurityLine(b,n,p,j){
  let e = makeEncryptedPassword(b,p);
  let base = `${b},${n.toLowerCase()},${j},99991231,${e},`;
  return base + makeMD5Hash(base);
}

/* üöÄ GENERATE */
function generateSecurityLine(){
  const b = document.getElementById("badge").value.trim();
  const n = document.getElementById("empName").value.trim();
  const p = document.getElementById("password").value.trim();
  const j = document.getElementById("job").value;

  if(!/^\d{1,10}$/.test(b)) return alert("Invalid badge");
  if(!/^[A-Za-z ]{1,25}$/.test(n)) return alert("Invalid name");
  if(!/^\d{1,10}$/.test(p)) return alert("Invalid password");

  const line = makeSecurityLine(b,n,p,j);
  output.textContent = line;
  addToHistory(line);
  showToast("Generated!");
}

/* üìã COPY */
function copyOutput(){
  if(output.textContent){
    navigator.clipboard.writeText(output.textContent);
    showToast("Copied!");
  }
}

/* üßæ HISTORY */
function loadHistory(){ return JSON.parse(localStorage.getItem("history") || "[]"); }
function saveHistory(x){ localStorage.setItem("history", JSON.stringify(x)); }
function addToHistory(t){
  let l = loadHistory();
  l.unshift({text:t, time:new Date().toLocaleString()});
  saveHistory(l);
}
function toggleHistory(){
  historyPanel.classList.toggle("open");
  renderHistory();
}
function renderHistory(){
  let l = loadHistory(), h = '<h3>History</h3>';
  if(!l.length) h += "<p>None yet</p>";
  l.forEach((x,i)=>h+=`
    <div class="history-item">
      ${x.text}<br><small>${x.time}</small><br>
      <button onclick="navigator.clipboard.writeText('${x.text}')">Copy</button>
      <button style="background:#e63946" onclick="deleteHistory(${i})">Delete</button>
    </div>`);
  historyPanel.innerHTML = h;
}
function deleteHistory(i){
  let l = loadHistory();
  l.splice(i,1);
  saveHistory(l);
  renderHistory();
}

/* üçû TOAST */
function showToast(t){
  toast.textContent = t;
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),1200);
}
</script>

</body>
</html>
